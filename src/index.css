@tailwind base;
@tailwind components;
@tailwind utilities;

/* =====================  BASE  ===================== */
@layer base {
  :root {
    /* -------- Core Palette -------- */
    --background: 200 60% 98%;
    --foreground: 220 15% 15%;

    --card: 0 0% 100%;
    --card-foreground: 220 15% 15%;

    --popover: 0 0% 100%;
    --popover-foreground: 220 15% 15%;

    --primary: 200 90% 50%;
    --primary-foreground: 0 0% 100%;

    --secondary: 195 85% 95%;
    --secondary-foreground: 195 85% 35%;

    --muted: 210 40% 96%;
    --muted-foreground: 215 16% 47%;

    --accent: 200 80% 94%;
    --accent-foreground: 195 85% 35%;

    --destructive: 0 84% 60%;
    --destructive-foreground: 0 0% 98%;

    --border: 210 40% 90%;
    --input: 210 40% 90%;
    --ring: 200 90% 50%;

    --radius: 1rem;

    /* -------- Effects -------- */
    --shadow-soft: 0 8px 24px -10px hsl(200 90% 40% / 0.12);
    --shadow-card: 0 4px 16px -6px hsl(200 90% 40% / 0.08);

    /* -------- Gradients -------- */
    --gradient-hero: linear-gradient(135deg, hsl(200 85% 50%) 0%, hsl(200 70% 60%) 100%);
    --gradient-card: linear-gradient(to bottom, hsl(0 0% 100%) 0%, hsl(200 80% 98%) 100%);
  }

  /* -------- Dark Mode -------- */
  .dark {
    --background: 215 25% 12%;
    --foreground: 0 0% 98%;

    --card: 215 25% 15%;
    --card-foreground: 0 0% 98%;

    --popover: 215 25% 15%;
    --popover-foreground: 0 0% 98%;

    --primary: 195 85% 55%;
    --primary-foreground: 0 0% 100%;

    --secondary: 215 25% 20%;
    --secondary-foreground: 0 0% 98%;

    --muted: 215 25% 20%;
    --muted-foreground: 215 20% 65%;

    --accent: 215 25% 22%;
    --accent-foreground: 195 85% 55%;

    --border: 215 25% 20%;
    --input: 215 25% 20%;
    --ring: 195 85% 55%;
  }

  /* -------- Base Styles -------- */
  /* * { @apply border-border; } */

  body {
    color: hsl(var(--foreground));
    @apply font-sans antialiased;
    background: linear-gradient(135deg, hsl(200 60% 98%) 0%, hsl(210 60% 96%) 100%);
  }

  h1, h2, h3, h4, h5 {
    @apply font-semibold tracking-tight;
    color: hsl(var(--foreground));
  }

  img { @apply select-none rounded-2xl; }  /* shadow-card */

  ::selection { background: hsl(200 90% 50% / .18); }
}


/* =====================  COMPONENTS  ===================== */
@layer components {
  /* ---- Buttons ---- */
  .btn-primary {
    background: hsl(var(--primary));
    color: white;
    @apply px-6 py-3 rounded-xl font-medium shadow-soft transition-all;
  }

  .btn-outline {
    border: 1px solid hsl(var(--border));
    color: hsl(var(--primary));
    background: hsla(0, 0%, 100%, 0.7);
    backdrop-filter: blur(4px);
    -webkit-backdrop-filter: blur(4px);
    @apply px-6 py-3 rounded-xl font-medium transition-all hover:shadow-soft;
  }

  .btn-outline:hover {
    background: hsl(var(--accent) / 0.6);
  }

  /* ---- Cards ---- */
  .card {
    background: hsl(0 0% 100% / 0.6);
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
    border: 1px solid hsl(var(--border));
    @apply rounded-2xl shadow-card transition-all hover:-translate-y-1 hover:shadow-soft;
  }

  /* ---- Hero container (для фоновых слоёв) ---- */
  .hero {
    position: relative;
    overflow: visible;
    --hero-overlap: 96px;
  }

  .hero h1 {color: white;}

  /* Фото на всю ширину */
  .hero::before {
    content: "";
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    width: 100vw;
    top: calc(var(--hero-overlap) * -1);
    bottom: 0;
    background-image: var(--hero-full-bg-image);
    background-size: cover;
    background-position: center 45%;
    opacity: var(--hero-image-opacity, .25);
    z-index: 0;
    pointer-events: none;
  }

  /* Голубая вуаль поверх фото */
  .hero::after {
    content: "";
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    width: 100vw;
    top: calc(var(--hero-overlap) * -1);
    bottom: 0;
    background: none;
    z-index: 0;
    pointer-events: none;
  }
  
  /* ---- Catalog section bg ---- */
  .catalog::before {
    content: "";
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    width: 100vw;
    top: calc(var(--catalog-overlap) * -1);
    bottom: 0;
    background-image: var(--catalog-full-bg-image);
    background-size: cover;
    background-position: center 45%;
    opacity: 1;
    z-index: 0;
    pointer-events: none;
  }

  .catalog .glass-card {
    background: white !important;
    border: 1px solid hsl(var(--border));
    backdrop-filter: none !important;
    -webkit-backdrop-filter: none !important;
  }

  /* Обёртка под стеклянные панели */
  .hero-scene { position: relative; }

  /* Контент в hero над фоном */
  .hero > * { position: relative; z-index: 1; }

  /* ---- NAV — жидкое стекло ---- */
  .nav-glass {
    position: relative;
    overflow: hidden;
    background: hsl(0 0% 100% / 0.12);
    backdrop-filter: blur(14px) saturate(150%);
    -webkit-backdrop-filter: blur(14px) saturate(150%);
    border: 1px solid hsl(0 0% 100% / .4);
    border-radius: 1.25rem;
    box-shadow:
      0 10px 24px -12px hsl(200 90% 40% / .14),
      inset 0 1px 0 hsl(0 0% 100% / .45);
    transition: background .25s ease, border-color .25s ease, box-shadow .25s ease;
  }


  .nav-glass-blurred {
    backdrop-filter: blur(10px) saturate(120%);
    -webkit-backdrop-filter: blur(10px) saturate(120%); 
  }

  .nav-glass::after {
    content: "";
    position: absolute;
    inset: 0;
    background: linear-gradient(to bottom, hsl(0 0% 100% / .16), transparent 60%);
    pointer-events: none;
  }

  .nav-glass--scrolled {
    background: hsl(0 0% 100% / .18);
    border-color: hsl(0 0% 100% / .55);
    box-shadow:
      0 14px 38px -10px hsl(200 90% 30% / .22),
      inset 0 1px 0 hsl(0 0% 100% / .38);
  }

  /* ---- Стеклянная панель ---- */
  .glass-panel {
    position: relative;
    overflow: hidden;
    background: transparent;
    border: 1px solid hsl(0 0% 100% / .60);
    backdrop-filter: saturate(170%) blur(14px);
    -webkit-backdrop-filter: saturate(170%) blur(14px);
    border-radius: 1.25rem;
    box-shadow:
      0 14px 32px -12px hsl(200 90% 40% / .16),
      0 -14px 32px -12px hsla(200,90%,40%,.18),
      12px 0 24px -16px hsl(200 90% 40% / .10),
      -12px 0 24px -16px hsl(200 90% 40% / .10),
      inset 0 1px 0 hsl(0 0% 100% / .35);
  }

  /* Фон панели */
  .glass-panel::before {
    content: "";
    position: absolute;
    inset: 0;
    background-size: cover;
    background-position: center;
    opacity: .2;
    z-index: 0;
    pointer-events: none;
  }

  .glass-panel > * { position: relative; z-index: 1; }


@media (min-width: 1024px) {

  .nav-glass nav a:empty::before {
    display: none;
    pointer-events: none;
  }

  .nav-glass nav a {
    position: relative;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    
    border-radius: 0.75rem;
    z-index: 1;
  }

  /* псевдофон под каждой ссылкой: монохромный градиент + blur + inset highlight */
  .nav-glass nav a::before {
    content: "";
    position: absolute;
    inset: 0;
    border-radius: inherit;
    background: linear-gradient(
      180deg,
      rgba(10,30,60,0.10) 0%,  /* верх — тонкий тёмный оттенок */
      rgba(255,255,255,0.03) 100% /* низ — лёгкая подсветка */
    );
    backdrop-filter: blur(10px) saturate(120%);
    -webkit-backdrop-filter: blur(10px) saturate(120%);
    pointer-events: none;
    z-index: -1;
  }

  /* не конфликтовать с уже существующей активной подсветкой */
  .nav-glass nav a[aria-current="page"]::before,
  .nav-glass nav a.active::before {
    opacity: 0;
  }  

  .glass-panel--hero {
    background: transparent;
    border: 1px solid rgba(255,255,255,0.18);
    backdrop-filter: blur(22px) saturate(150%);
    -webkit-backdrop-filter: blur(22px) saturate(150%);
    border-radius: 28px;
    padding: clamp(48px, 5.6vw, 80px);
    min-height: calc(100svh - var(--hero-top-gap) - var(--hero-bottom-gap));
    box-shadow:
      0 30px 60px -30px rgba(4,22,50,0.65),
      inset 0 1px 0 rgba(255,255,255,0.06),
      0 10px 40px -20px rgba(20,80,160,0.12);
    overflow: hidden;
  }

  .glass-panel--hero .glass-card {
    background: rgba(6, 20, 44, 0.42);     /* плотная синяя/полупрозрачная основа */
    opacity: 1;
    border: 1px solid rgba(255, 255, 255, 0.08); /* светлая тонкая граница */
    backdrop-filter: blur(6px) saturate(140%); /* меньше размытия — карточки чётче */
    -webkit-backdrop-filter: blur(6px) saturate(140%);
    box-shadow: 0 10px 30px -18px rgba(2,12,30,0.6), inset 0 1px 0 rgba(255,255,255,0.03);
    color: rgba(255,255,255,0.95); /* текст — светлый */
  }

  /* Иконки и заголовки карточек — ярче */
  .glass-panel--hero .glass-card p,
  .glass-panel--hero .glass-card .lucide {
    color: rgba(255,255,255,0.96);
  }

  /* Если внутри карточки есть фон для иконки — делаем его чуть прозрачнее/светлее */
  .glass-panel--hero .glass-card > * .p-3 {
    background: rgba(255,255,255,0.06); /* тонкий фон под иконкой */
  }

  .glass-panel--hero .glass-card {
    padding: 0.5rem;
    border-radius: 1rem;
  }

  .glass-panel--hero h1 {
    color: #fff;
    font-size: clamp(36px, 4.6vw, 64px);
    line-height: 1.02;
    letter-spacing: -0.01em;
    text-shadow: 0 6px 30px rgba(2,10,30,0.55);
  }

  .glass-panel--hero p {
    color: rgba(255,255,255,0.86);
    text-shadow: 0 2px 12px rgba(2,10,30,0.45);
  }

  /* CTA — делаем чуть ярче и с лёгким glow */
  .glass-panel--hero .btn-primary {
    background: linear-gradient(180deg, hsl(200 90% 55%), hsl(200 85% 46%));
    box-shadow: 0 12px 30px -10px rgba(10,110,210,0.28), 0 4px 12px rgba(6,18,40,0.12);
  }

  /* KPI карточки — более монохромные, чуть прозрачнее (как на референсе) */
  .glass-panel--hero .glass-card {
    background: rgba(255,255,255,0.12);
    border: 1px solid rgba(255,255,255,0.08);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    box-shadow: 0 8px 28px -18px rgba(4,22,50,0.6), inset 0 1px 0 rgba(255,255,255,0.04);
    color: rgba(255,255,255,0.95);
  }

  .glass-panel--hero .glass-card p,
  .glass-panel--hero .glass-card .lucide {
    color: rgba(255,255,255,0.95);
  }

  /* optional subtle border glow around the panel (outer glow) */
  .glass-panel--hero {
    outline: 1px solid rgba(100,170,255,0.02);
    box-shadow:
      0 30px 80px -30px rgba(4,22,50,0.72),
      0 2px 0 1px rgba(80,160,255,0.02),
      inset 0 1px 0 rgba(255,255,255,0.04);
  }
}

  /* Карточки поверх стекла (KPI) */
  .glass-card {
    background: hsl(0 0% 100% / .70);
    border: 1px solid hsl(var(--border) / .9);
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
    border-radius: 1rem;
    box-shadow: 0 6px 20px -12px hsl(200 90% 40% / .12);
    isolation: isolate;
  }

  /* фолбэк без blur для nav */
  @supports not ((backdrop-filter: blur(1px)) or (-webkit-backdrop-filter: blur(1px))) {
    .nav-glass { background: hsl(0 0% 100% / .7); }
  }}

  /* ---- Fallback без blur для панелей/карточек ---- */
  @supports not ((backdrop-filter: blur(1px)) or (-webkit-backdrop-filter: blur(1px))) {
    .glass-panel { background: hsl(0 0% 100% / .88); }
    .glass-card  { background: hsl(0 0% 100% / .92); }
  }


/* =====================  UTILITIES  ===================== */
@layer utilities {
  /* независимые стек-слои */
  .isolate { isolation: isolate; }

  /* быстрые уровни для контента */
  .z-content { position: relative; z-index: 2; }
  .z-decor   { position: relative; z-index: 1; }

  /* у стеклянных панелей псевдофон гарантированно ниже */
  .glass-panel::before { z-index: 0; }
  .glass-panel > *     { position: relative; z-index: 1; }

  /* карточки тоже изолируем */
  .glass-card { isolation: isolate; }

  .bg-blur {
    background: rgba(255, 255, 255, 0.6);
    backdrop-filter: blur(16px);
    -webkit-backdrop-filter: blur(16px);
  }

  .page-gutter { margin-inline: .5rem; }
  @media (min-width:768px){ .page-gutter{ margin-inline: 1rem; } }

  .scroll-smooth { scroll-behavior: smooth; }
}

/* =====================  MOBILE TWEAKS  ===================== */
@media (max-width: 768px) {

  .glass-panel::before { background-image: none; --panel-bg-opacity: 0; }

  .nav-glass { border-radius: 14px; }

  .glass-panel {
    min-height: 300px;
    border-radius: 16px;
    padding-block: clamp(18px, 3vw, 32px);
  }

  .hero-scene::after {
    background:
      radial-gradient(520px 360px at 24% 22%, hsl(200 80% 96% / .92), transparent 58%),
      linear-gradient(135deg, hsl(205 70% 97% / .92), hsl(200 60% 98% / .92));
  }
}
