# ๐ Payme Integration - ะะพะปะฝะฐั ะดะพะบัะผะตะฝัะฐัะธั

ะั ััะฟะตัะฝะพ ะธะฝัะตะณัะธัะพะฒะฐะปะธ **Payme** - ัะทะฑะตะบัะบัั ะฟะปะฐัะตะถะฝัั ัะธััะตะผั ะฒ ะฒะฐั ะฟัะพะตะบั.

## ๐ฏ ะัััััะน ััะฐัั (ะฒัะฑะตัะธัะต ะฒะฐั ััะพะฒะตะฝั)

### ๐ถ ะฏ ะฝะพะฒะธัะพะบ - ะฝะฐัะฝะธ ะพัััะดะฐ
1. [PAYME_QUICK_START.md](./PAYME_QUICK_START.md) - 5 ะผะธะฝัั ะดะปั ะฟะพะฝะธะผะฐะฝะธั
2. [PAYME_CHECKLIST.md](./PAYME_CHECKLIST.md) - ะะพัะฐะณะพะฒัะต ะธะฝััััะบัะธะธ
3. [test-payme.js](./test-payme.js) - ะัะพัะตััะธััะนัะต ะปะพะบะฐะปัะฝะพ

### ๐งโ๐ป ะฏ ัะฐะทัะฐะฑะพััะธะบ - ัะผะพััะธ ะดะพะบัะผะตะฝัะฐัะธั
1. [PAYME_INTEGRATION.md](./PAYME_INTEGRATION.md) - ะะพะปะฝะฐั ัะตัะฝะธัะตัะบะฐั ะดะพะบัะผะตะฝัะฐัะธั
2. [PAYME_IKPU_USAGE.md](./PAYME_IKPU_USAGE.md) - ะะฐะบ ะธัะฟะพะปัะทัะตััั ะะะะฃ ะบะพะด
3. [backend/controllers/paymentController.js](./backend/controllers/paymentController.js) - ะััะพะดะฝัะน ะบะพะด

### ๐ป Frontend ัะฐะทัะฐะฑะพััะธะบ
1. [FRONTEND_PAYME_INTEGRATION.md](./FRONTEND_PAYME_INTEGRATION.md) - Frontend ะธะฝัะตะณัะฐัะธั
2. [src/examples/PaymentIntegrationExample.tsx](./src/examples/PaymentIntegrationExample.tsx) - ะัะธะผะตัั ะบะพะดะฐ

---

## ๐ ะัะต ะดะพะบัะผะตะฝัั

| ะะพะบัะผะตะฝั | ะะฟะธัะฐะฝะธะต | ะะปั ะบะพะณะพ |
|----------|---------|---------|
| [PAYME_QUICK_START.md](./PAYME_QUICK_START.md) | ะััััะพะต ะฒะฒะตะดะตะฝะธะต (5 ะผะธะฝ) | ๐ถ ะัะต |
| [PAYME_INTEGRATION.md](./PAYME_INTEGRATION.md) | ะะพะปะฝะฐั ัะตัะฝะธัะตัะบะฐั ะดะพะบัะผะตะฝัะฐัะธั | ๐งโ๐ป Backend |
| [PAYME_CHECKLIST.md](./PAYME_CHECKLIST.md) | ะะพัะฐะณะพะฒัะน ัะตะบ-ะปะธัั ะฟะพะดะบะปััะตะฝะธั | โ ะัะต |
| [PAYME_IKPU_USAGE.md](./PAYME_IKPU_USAGE.md) | ะะฐะบ ะธัะฟะพะปัะทะพะฒะฐัั ะะะะฃ ะบะพะด | ๐ง Backend |
| [FRONTEND_PAYME_INTEGRATION.md](./FRONTEND_PAYME_INTEGRATION.md) | Frontend ะธะฝัะตะณัะฐัะธั | ๐ป Frontend |
| [PAYME_README.md](./PAYME_README.md) | ะะพะผะฟะฐะบัะฝะพะต ัะตะทัะผะต | ๐ ะัะต |
| [.env.example](./.env.example) | ะัะธะผะตั ะฟะตัะตะผะตะฝะฝัั ะพะบััะถะตะฝะธั | โ๏ธ DevOps |

---

## ๐ ะะปััะตะฒัะต ะบะพะฝัะตะฟัะธะธ

### ะะะะฃ ะะพะด (Merchant ID)
**16-ะทะฝะฐัะฝัะน ัะฝะธะบะฐะปัะฝัะน ะธะดะตะฝัะธัะธะบะฐัะพั** ะฒะฐัะตะณะพ ััะตัะฐ ะฒ ัะธััะตะผะต Payme.
- ะะพะปััะธัะต ะฝะฐ https://merchant.paycom.uz
- ะัะฟะพะปัะทัะตััั ะฒ ะฟะตัะตะผะตะฝะฝะพะน `PAYME_MERCHANT_ID`
- ะฃะบะฐะทัะฒะฐะตััั ะฒ URL ะฟะปะฐัะตะถะฝะพะณะพ ัะปัะทะฐ

### API Receiver
Backend endpoint ะดะปั ะฟะพะปััะตะฝะธั callbacks ะพั Payme:
```
POST /api/payments/payme/callback
```

### Callbacks ะพั Payme
1. **CheckPerformTransaction** - ะฟัะพะฒะตัะบะฐ ะฟะตัะตะด ะฟะปะฐัะตะถะพะผ
2. **PerformTransaction** - ะฟะพะดัะฒะตัะถะดะตะฝะธะต ะฟะปะฐัะตะถะฐ
3. **CancelTransaction** - ะพัะผะตะฝะฐ ะฟะปะฐัะตะถะฐ

---

## ๐ ะัะพััะพะน ััะฐัั (3 ัะฐะณะฐ)

### 1๏ธโฃ ะะพะปััะธัะต ะะะะฃ ะบะพะด
ะะฐัะตะณะธัััะธััะนัะตัั ะฝะฐ https://merchant.paycom.uz ะธ ะฟะพะปััะธัะต 16-ะทะฝะฐัะฝัะน ะบะพะด.

### 2๏ธโฃ ะะฑะฝะพะฒะธัะต .env
```env
PAYME_MERCHANT_ID=ะฒะฐั_16_ะทะฝะฐัะฝัะน_ะบะพะด
PAYME_KEY=ะฒะฐั_api_ะบะปัั
PAYME_TEST_MODE=false
```

### 3๏ธโฃ ะฃััะฐะฝะพะฒะธัะต Callback URL
ะ ะบะฐะฑะธะฝะตัะต Payme ัััะฐะฝะพะฒะธัะต:
```
https://your-domain.com/api/payments/payme/callback
```

**ะะพัะพะฒะพ!** โ

---

## ๐ ะกัััะบัััะฐ ัะฐะนะปะพะฒ

```
medical_care/
โโโ PAYME_INTEGRATION.md โ (ะฟะพะปะฝะฐั ัะตัะดะพะบัะผะตะฝัะฐัะธั)
โโโ PAYME_QUICK_START.md โ (ะฑัััััะน ััะฐัั)
โโโ PAYME_CHECKLIST.md โ (ัะตะบ-ะปะธัั)
โโโ PAYME_IKPU_USAGE.md โ (ะบะฐะบ ะธัะฟะพะปัะทะพะฒะฐัั ะะะะฃ)
โโโ PAYME_README.md โ (ัะตะทัะผะต)
โโโ FRONTEND_PAYME_INTEGRATION.md โ (frontend)
โโโ PAYME_DOCUMENTATION_INDEX.md โ (ััะพั ัะฐะนะป)
โโโ .env.example โ (ะฟะตัะตะผะตะฝะฝัะต)
โโโ test-payme.js โ (ัะตััะธัะพะฒะฐะฝะธะต)
โโโ test-payme.sh โ (bash ัะตััั)
โ
โโโ backend/
โ   โโโ controllers/
โ   โ   โโโ paymentController.js โ (ะพะฑัะฐะฑะพัะบะฐ ะฟะปะฐัะตะถะตะน)
โ   โโโ routes/
โ       โโโ payment.js โ (endpoints)
โ
โโโ src/
โ   โโโ examples/
โ       โโโ PaymentIntegrationExample.tsx โ (ะฟัะธะผะตัั frontend)
โ
โโโ ... (ะพััะฐะปัะฝัะต ัะฐะนะปั ะฟัะพะตะบัะฐ)
```

---

## ๐ Workflow ะฟะปะฐัะตะถะฐ

```
โโ Frontend โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ User ะฝะฐะถะธะผะฐะตั "ะะฟะปะฐัะธัั Payme"        โ
โ POST /api/payments/create              โ
โ   { items, amount, provider: 'payme' } โ
โโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโ
             โ
             โ
โโ Backend โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ 1. ะกะพะทะดะฐะตั ะทะฐะบะฐะท (pending)            โ
โ 2. ะะพะทะฒัะฐัะฐะตั URL ะฟะปะฐัะตะถะฝะพะณะพ ัะปัะทะฐ    โ
โ URL: https://checkout.paycom.uz/...   โ
โโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโ
             โ
             โ
โโ Frontend โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ window.location.href = redirectUrl     โ
โ User ะฒะธะดะธั ัะพัะผั Payme                 โ
โโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโ
             โ
             โ
โโ Payme Gateway โโโโโโโโโโโโโโโโโโโโโโโโโ
โ User ะฒะฒะพะดะธั ะดะฐะฝะฝัะต ะบะฐััั               โ
โ User ะฟะพะดัะฒะตัะถะดะฐะตั ะฟะปะฐัะตะถ               โ
โโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโ
             โ
             โ
โโ Backend (Callback) โโโโโโโโโโโโโโโโโโโโ
โ Payme ะพัะฟัะฐะฒะปัะตั:                      โ
โ POST /api/payments/payme/callback      โ
โ                                        โ
โ CheckPerformTransaction                โ
โ   โ Backend ะฟัะพะฒะตััะตั ะทะฐะบะฐะท            โ
โ   โ ะะพะทะฒัะฐัะฐะตั ัะตะทัะปััะฐั               โ
โ                                        โ
โ PerformTransaction                     โ
โ   โ Backend ะพะฑะฝะพะฒะปัะตั ะทะฐะบะฐะท (paid)     โ
โ   โ ะัะฟัะฐะฒะปัะตั Telegram ัะฒะตะดะพะผะปะตะฝะธะต    โ
โ   โ ะะพะทะฒัะฐัะฐะตั ะฟะพะดัะฒะตัะถะดะตะฝะธะต           โ
โโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโ
             โ
             โ
        โ ะะปะฐัะตะถ ะทะฐะฒะตััะตะฝ
```

---

## ๐งช ะขะตััะธัะพะฒะฐะฝะธะต

### ะะพะบะฐะปัะฝะพะต ัะตััะธัะพะฒะฐะฝะธะต
```bash
# 1. ะะฐะฟัััะธัะต backend
npm run dev

# 2. ะะฐะฟัััะธัะต ัะตััั
node test-payme.js

# 3. ะะปะธ ะธัะฟะพะปัะทัะนัะต bash
bash test-payme.sh
```

### ะขะตััะพะฒัะต ะดะฐะฝะฝัะต
```
Merchant ID: 507144
API Key: 0300BF8B4D537FD49D1F1E13B5215E58

Visa: 4111 1111 1111 1111
MasterCard: 5105 1051 0510 5100
```

---

## ๐ ะะตัะตะฝะธะต ะฟัะพะฑะปะตะผ

### "Authorization failed"
โ ะัะพะฒะตัััะต `PAYME_KEY` ะฒ `.env`

### "Order not found"
โ ะฃะฑะตะดะธัะตัั ััะพ ะทะฐะบะฐะท ัะพะทะดะฐะฝ ะฒ ะะ

### "Amount mismatch"
โ Backend ะฐะฒัะพะผะฐัะธัะตัะบะธ ะบะพะฝะฒะตััะธััะตั (x100)

### "Callback ะฝะต ะฟัะธัะพะดะธั"
โ ะฃััะฐะฝะพะฒะธัะต ะฟัะฐะฒะธะปัะฝัะน URL ะฒ ะบะฐะฑะธะฝะตัะต Payme

---

## ๐ ะะพะฝัะฐะบัั

**Payme Support:**
- Email: merchant@paycom.uz
- Phone: +998 71 200-0-200
- Docs: https://paycom.uz/ru/developers/

---

## โ Pre-Production Checklist

ะะตัะตะด ะทะฐะฟััะบะพะผ ะฒ production:

- [ ] ะะะะฃ ะบะพะด ะฟะพะปััะตะฝ ะธ ัะพััะฐะฝะตะฝ
- [ ] API Key ัะพััะฐะฝะตะฝ ะฒ ะฟะตัะตะผะตะฝะฝัั ะพะบััะถะตะฝะธั
- [ ] Callback URL ัััะฐะฝะพะฒะปะตะฝ ะฒ Payme ะบะฐะฑะธะฝะตั
- [ ] Backend ะพะฑะฝะพะฒะปะตะฝ ะธ ะฟะตัะตะทะฐะณััะถะตะฝ
- [ ] HTTPS ะฒะบะปััะตะฝ
- [ ] SSL ัะตััะธัะธะบะฐั ะดะตะนััะฒะธัะตะปะตะฝ
- [ ] ะขะตััะพะฒัะน ะฟะปะฐัะตะถ ะฒัะฟะพะปะฝะตะฝ ััะฟะตัะฝะพ
- [ ] ะะฐะบะฐะท ะพะฑะฝะพะฒะธะปัั ะฒ ะะ ะฝะฐ "paid"
- [ ] Telegram ัะฒะตะดะพะผะปะตะฝะธะต ะฟัะธัะปะพ ะฐะดะผะธะฝั
- [ ] PAYME_TEST_MODE = false
- [ ] Real ะะะะฃ ะบะพะด ะธัะฟะพะปัะทัะตััั
- [ ] Real API Key ะธัะฟะพะปัะทัะตััั

---

## ๐ ะะพะฟะพะปะฝะธัะตะปัะฝะพ

### ะะปั Backend ัะฐะทัะฐะฑะพััะธะบะพะฒ
1. ะัะพัะธัะฐะนัะต [PAYME_INTEGRATION.md](./PAYME_INTEGRATION.md)
2. ะะทััะธัะต ะบะพะด ะฒ [backend/controllers/paymentController.js](./backend/controllers/paymentController.js)
3. ะะพัะผะพััะธัะต ะฟัะธะผะตัั callbacks

### ะะปั Frontend ัะฐะทัะฐะฑะพััะธะบะพะฒ
1. ะัะพัะธัะฐะนัะต [FRONTEND_PAYME_INTEGRATION.md](./FRONTEND_PAYME_INTEGRATION.md)
2. ะัะฟะพะปัะทัะนัะต ะฟัะธะผะตัั ะธะท [PaymentIntegrationExample.tsx](./src/examples/PaymentIntegrationExample.tsx)
3. ะะฝัะตะณัะธััะนัะต ะฒ ะฒะฐัะธ ะบะพะผะฟะพะฝะตะฝัั

### ะะปั DevOps
1. ะะพัะผะพััะธัะต [.env.example](./.env.example)
2. ะฃััะฐะฝะพะฒะธัะต ะฟะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั
3. ะฃะฑะตะดะธัะตัั ะฒ HTTPS ะธ SSL ัะตััะธัะธะบะฐัะฐั

---

## ๐ ะะพัะพะฒะพ!

ะะฐัะฐ ะธะฝัะตะณัะฐัะธั **Payme** ะฟะพะปะฝะพัััั ะฝะฐัััะพะตะฝะฐ ะธ ะณะพัะพะฒะฐ ะบ ะธัะฟะพะปัะทะพะฒะฐะฝะธั.

**ะัะฑะตัะธัะต ะดะพะบัะผะตะฝั ะฒััะต ะธ ะฝะฐัะฝะธัะต!** ๐

---

*ะะพัะปะตะดะฝะตะต ะพะฑะฝะพะฒะปะตะฝะธะต: 2024*
*ะะตััะธั Payme API: JSON-RPC 2.0*
